Задание 2. Пусть задан некоторый пользователь. 
Из всех друзей этого пользователя найдите человека, который больше всех общался с нашим пользователем.
 
SELECT from_user_id, count(*) FROM messages 
  	WHERE to_user_id = 1 
  	GROUP BY from_user_id 
  	ORDER BY count(*) DESC  LIMIT 1

Задание 3. Подсчитать общее количество лайков, которые получили 10 самых молодых пользователей.

SELECT	count(*) as likes FROM post_likes
	WHERE post_id in (
	SELECT id
	FROM posts as youngest
	WHERE user_id in (
		SELECT *
		FROM (SELECT id
			FROM users as youngest
			ORDER BY timestampdiff(day, birthday, now())
			LIMIT 10) as youngest_users));

Задание 4. Определить кто больше поставил лайков (всего) - мужчины или женщины?

SELECT
	(SELECT gender FROM profiles WHERE user_id = likes.user_id) AS gender
    FROM likes; 

SELECT
	(SELECT gender FROM profiles WHERE user_id = likes.user_id) AS gender,
	COUNT(*) AS total
    FROM likes
    GROUP BY gender
    ORDER BY total DESC
    LIMIT 2;  

Задание 5. Найти 10 пользователей, которые проявляют наименьшую активность в использовании социальной сети.

SELECT 
  CONCAT(first_name, ' ', surname) AS user, 
	(SELECT COUNT(*) FROM likes WHERE likes.user_id = users.id) + 
	(SELECT COUNT(*) FROM messages WHERE messages.from_user_id = users.id) AS activity 
	  FROM users
	  ORDER BY activity
	  LIMIT 10;